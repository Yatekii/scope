%%
clear all; close all; clc;

N = 512;
n = 1:N;

fs = 200e3; T = 1/fs;
f = 1e3;

xmatlab = cos(2*pi*f*n*T);
xJS = [-0.055255126953124956, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05126037597656241, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.0441436767578125, -0.041961669921875, -0.039578247070312544, -0.03702697753906259, -0.034375000000000044, -0.03155517578125, -0.02863464355468759, -0.02561340332031259, -0.022457885742187544, -0.019268798828125044, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005841064453125044, -0.0023834228515624556, 0.0010406494140624556, 0.004498291015625044, 0.007922363281249956, 0.011279296874999956, 0.0146026611328125, 0.01785888671874991, 0.02104797363281241, 0.024169921875, 0.027191162109375, 0.0300445556640625, 0.03283081054687509, 0.03548278808593741, 0.037933349609375, 0.040283203125, 0.0424652099609375, 0.0444793701171875, 0.046292114257812544, 0.04793701171875009, 0.04941406249999991, 0.050656127929687544, 0.05169677734375, 0.0525360107421875, 0.053173828125000044, 0.0535430908203125, 0.053744506835937456, 0.053677368164062544, 0.053408813476562456, 0.05293884277343741, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.04894409179687509, 0.04743347167968759, 0.04575500488281259, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.02927246093749991, 0.0263519287109375, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010339355468750089, 0.006915283203124956, 0.0035247802734375, 6.713867187491118e-05, -0.0033905029296874556, -0.006814575195312589, -0.010205078125000044, -0.0135955810546875, -0.016918945312500044, -0.02020874023437491, -0.02339782714843741, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.037799072265624956, -0.040283203125, -0.042599487304687544, -0.044781494140625044, -0.046795654296875044, -0.04860839843750009, -0.05025329589843741, -0.051663208007812544, -0.052905273437499956, -0.05394592285156241, -0.05478515624999991, -0.055389404296875, -0.05579223632812491, -0.05599365234375009, -0.05596008300781241, -0.055691528320312544, -0.055255126953124956, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05126037597656241, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.044177246093749956, -0.041961669921875, -0.039578247070312544, -0.03702697753906259, -0.034375000000000044, -0.03155517578125, -0.02863464355468759, -0.02561340332031259, -0.022491455078125, -0.019268798828125044, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005807495117187589, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011279296874999956, 0.014636230468749956, 0.01789245605468759, 0.02108154296875009, 0.024169921875, 0.027191162109375, 0.030078124999999956, 0.03283081054687509, 0.03548278808593741, 0.037966918945312456, 0.040316772460937456, 0.0424652099609375, 0.044512939453124956, 0.046292114257812544, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.051730346679687456, 0.0525360107421875, 0.053173828125000044, 0.0535430908203125, 0.053744506835937456, 0.053677368164062544, 0.05344238281249991, 0.05293884277343741, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.04894409179687509, 0.047467041015625044, 0.045788574218750044, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.02927246093749991, 0.026318359375000044, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010339355468750089, 0.006948852539062411, 0.0034912109375000444, 6.713867187491118e-05, -0.0033905029296874556, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.016918945312500044, -0.02020874023437491, -0.02339782714843741, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.0377655029296875, -0.040249633789062544, -0.042599487304687544, -0.044781494140625044, -0.04676208496093759, -0.04860839843750009, -0.050219726562499956, -0.051663208007812544, -0.052905273437499956, -0.05394592285156241, -0.05478515624999991, -0.055389404296875, -0.05579223632812491, -0.05599365234375009, -0.055926513671874956, -0.055691528320312544, -0.0552215576171875, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05126037597656241, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.044177246093749956, -0.041961669921875, -0.039578247070312544, -0.03702697753906259, -0.034375000000000044, -0.03155517578125, -0.02863464355468759, -0.02561340332031259, -0.022457885742187544, -0.01923522949218759, -0.0159454345703125, -0.012622070312499956, -0.0092315673828125, -0.005773925781249911, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011279296874999956, 0.0146026611328125, 0.01789245605468759, 0.02104797363281241, 0.024169921875, 0.027157592773437544, 0.030078124999999956, 0.03283081054687509, 0.03548278808593741, 0.037933349609375, 0.040283203125, 0.042498779296874956, 0.0444793701171875, 0.04632568359375, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.05169677734375, 0.0525360107421875, 0.05314025878906259, 0.0535430908203125, 0.0537109375, 0.053677368164062544, 0.053408813476562456, 0.05293884277343741, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.04894409179687509, 0.047467041015625044, 0.04575500488281259, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.02927246093749991, 0.026318359375000044, 0.023297119140625044, 0.020175170898437456, 0.016918945312500044, 0.013662719726562411, 0.010305786132812411, 0.006915283203124956, 0.0034912109375000444, 6.713867187491118e-05, -0.0033905029296874556, -0.006848144531250044, -0.0102386474609375, -0.013629150390624956, -0.0169525146484375, -0.02020874023437491, -0.02339782714843741, -0.026519775390625, -0.029507446289062544, -0.0323944091796875, -0.03518066406250009, -0.037799072265624956, -0.040283203125, -0.042633056640625, -0.044781494140625044, -0.046795654296875044, -0.04857482910156241, -0.05025329589843741, -0.051663208007812544, -0.052905273437499956, -0.05394592285156241, -0.054751586914062456, -0.055389404296875, -0.055758666992187456, -0.05599365234375009, -0.055926513671874956, -0.055691528320312544, -0.0552215576171875, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05126037597656241, -0.04978332519531259, -0.04807128906249991, -0.04622497558593741, -0.044177246093749956, -0.041961669921875, -0.039578247070312544, -0.03702697753906259, -0.034375000000000044, -0.03155517578125, -0.02863464355468759, -0.02561340332031259, -0.022491455078125, -0.019268798828125044, -0.015979003906249956, -0.012655639648437411, -0.009265136718749956, -0.005807495117187589, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011312866210937411, 0.0146026611328125, 0.01789245605468759, 0.02108154296875009, 0.024169921875, 0.027157592773437544, 0.030078124999999956, 0.03283081054687509, 0.03548278808593741, 0.037933349609375, 0.040283203125, 0.0424652099609375, 0.0444793701171875, 0.046292114257812544, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.05169677734375, 0.0525360107421875, 0.05314025878906259, 0.0535430908203125, 0.0537109375, 0.053677368164062544, 0.05344238281249991, 0.05293884277343741, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.04894409179687509, 0.04743347167968759, 0.045788574218750044, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.032092285156249956, 0.029238891601562456, 0.0263519287109375, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013696289062500089, 0.010305786132812411, 0.006915283203124956, 0.0035247802734375, 6.713867187491118e-05, -0.00335693359375, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.0169525146484375, -0.02020874023437491, -0.02339782714843741, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03518066406250009, -0.037799072265624956, -0.040283203125, -0.042633056640625, -0.044781494140625044, -0.046795654296875044, -0.04860839843750009, -0.05025329589843741, -0.051663208007812544, -0.05293884277343741, -0.05394592285156241, -0.05478515624999991, -0.055389404296875, -0.05579223632812491, -0.05596008300781241, -0.05596008300781241, -0.055691528320312544, -0.055255126953124956, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05129394531250009, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.044177246093749956, -0.041961669921875, -0.039578247070312544, -0.037060546875000044, -0.034375000000000044, -0.03155517578125, -0.02863464355468759, -0.02561340332031259, -0.022491455078125, -0.01923522949218759, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005807495117187589, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011279296874999956, 0.0146026611328125, 0.01789245605468759, 0.02104797363281241, 0.024169921875, 0.027157592773437544, 0.030078124999999956, 0.03283081054687509, 0.03548278808593741, 0.037966918945312456, 0.040283203125, 0.0424652099609375, 0.044512939453124956, 0.04632568359375, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.05169677734375, 0.0525360107421875, 0.053173828125000044, 0.0535430908203125, 0.053744506835937456, 0.053677368164062544, 0.053408813476562456, 0.05297241210937509, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.04894409179687509, 0.047467041015625044, 0.04575500488281259, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.029238891601562456, 0.026318359375000044, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010339355468750089, 0.006948852539062411, 0.0034912109375000444, 6.713867187491118e-05, -0.0033905029296874556, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.0169525146484375, -0.02020874023437491, -0.02339782714843741, -0.026519775390625, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.037799072265624956, -0.040283203125, -0.042633056640625, -0.044781494140625044, -0.04676208496093759, -0.04860839843750009, -0.050219726562499956, -0.051663208007812544, -0.05293884277343741, -0.053912353515624956, -0.05478515624999991, -0.055355834960937544, -0.05579223632812491, -0.05596008300781241, -0.05596008300781241, -0.055691528320312544, -0.0552215576171875, -0.0545501708984375, -0.053677368164062544, -0.05260314941406241, -0.05129394531250009, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.044177246093749956, -0.041961669921875, -0.039578247070312544, -0.03702697753906259, -0.034375000000000044, -0.03155517578125, -0.02863464355468759, -0.02557983398437491, -0.022491455078125, -0.019268798828125044, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005807495117187589, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011312866210937411, 0.0146026611328125, 0.01789245605468759, 0.02108154296875009, 0.024169921875, 0.027191162109375, 0.030078124999999956, 0.032864379882812544, 0.03548278808593741, 0.037966918945312456, 0.040316772460937456, 0.0424652099609375, 0.044512939453124956, 0.04632568359375, 0.047970581054687544, 0.04941406249999991, 0.050689697265625, 0.05169677734375, 0.0525360107421875, 0.053173828125000044, 0.0535430908203125, 0.0537109375, 0.053677368164062544, 0.05344238281249991, 0.05293884277343741, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.048977661132812544, 0.047467041015625044, 0.045788574218750044, 0.04390869140625009, 0.04189453125000009, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.02927246093749991, 0.0263519287109375, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010305786132812411, 0.006948852539062411, 0.0034912109375000444, 6.713867187491118e-05, -0.0033905029296874556, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.0169525146484375, -0.02020874023437491, -0.02339782714843741, -0.026519775390625, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.037799072265624956, -0.040283203125, -0.042599487304687544, -0.0448150634765625, -0.046795654296875044, -0.04857482910156241, -0.05025329589843741, -0.051663208007812544, -0.05293884277343741, -0.05394592285156241, -0.05478515624999991, -0.055389404296875, -0.05579223632812491, -0.05596008300781241, -0.05596008300781241, -0.055691528320312544, -0.0552215576171875, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05126037597656241, -0.04978332519531259, -0.04807128906249991, -0.04622497558593741, -0.044177246093749956, -0.041961669921875, -0.03954467773437509, -0.037060546875000044, -0.03434143066406259, -0.03155517578125, -0.02863464355468759, -0.02561340332031259, -0.022457885742187544, -0.019268798828125044, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005807495117187589, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011279296874999956, 0.014636230468749956, 0.01789245605468759, 0.02104797363281241, 0.024169921875, 0.027157592773437544, 0.030078124999999956, 0.03283081054687509, 0.03551635742187509, 0.037933349609375, 0.040316772460937456, 0.042498779296874956, 0.044512939453124956, 0.04632568359375, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.051730346679687456, 0.0525360107421875, 0.053173828125000044, 0.0535430908203125, 0.0537109375, 0.053677368164062544, 0.053408813476562456, 0.05293884277343741, 0.052233886718749956, 0.051361083984375, 0.05025329589843741, 0.04894409179687509, 0.047467041015625044, 0.045788574218750044, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.02927246093749991, 0.0263519287109375, 0.023297119140625044, 0.0201416015625, 0.0169525146484375, 0.013662719726562411, 0.010305786132812411, 0.006915283203124956, 0.0034912109375000444, 3.356933593745559e-05, -0.0033905029296874556, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.016918945312500044, -0.02020874023437491, -0.023364257812499956, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.0377655029296875, -0.040283203125, -0.042599487304687544, -0.0448150634765625, -0.046795654296875044, -0.04860839843750009, -0.050219726562499956, -0.05169677734375, -0.052905273437499956, -0.05397949218750009, -0.05478515624999991, -0.055355834960937544, -0.05579223632812491, -0.05596008300781241, -0.055926513671874956, -0.05572509765625, -0.0552215576171875, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05129394531250009, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.044177246093749956, -0.041928100585937544, -0.03954467773437509, -0.037060546875000044, -0.03434143066406259, -0.03155517578125, -0.02863464355468759, -0.02557983398437491, -0.022457885742187544, -0.019268798828125044, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005841064453125044, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011312866210937411, 0.0146026611328125, 0.01789245605468759, 0.02108154296875009, 0.024169921875, 0.027191162109375, 0.030078124999999956, 0.03283081054687509, 0.03548278808593741, 0.037933349609375, 0.040316772460937456, 0.0424652099609375, 0.044512939453124956, 0.046292114257812544, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.05169677734375, 0.0525360107421875, 0.05314025878906259, 0.0535430908203125, 0.0537109375, 0.053677368164062544, 0.05344238281249991, 0.05297241210937509, 0.05226745605468741, 0.051361083984375, 0.05028686523437509, 0.048977661132812544, 0.047467041015625044, 0.04575500488281259, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.0320587158203125, 0.02927246093749991, 0.0263519287109375, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010305786132812411, 0.006948852539062411, 0.0034912109375000444, 6.713867187491118e-05, -0.0033905029296874556, -0.006814575195312589, -0.0102386474609375, -0.013629150390624956, -0.016918945312500044, -0.02020874023437491, -0.02339782714843741, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.037799072265624956, -0.040283203125, -0.042599487304687544, -0.0448150634765625, -0.04676208496093759, -0.04860839843750009, -0.050219726562499956, -0.05169677734375, -0.052905273437499956, -0.05394592285156241, -0.05478515624999991, -0.055389404296875, -0.05579223632812491, -0.05596008300781241, -0.055926513671874956, -0.055691528320312544, -0.0552215576171875, -0.0545501708984375, -0.05364379882812509, -0.052569580078124956, -0.05126037597656241, -0.04974975585937491, -0.04810485839843759, -0.046191406249999956, -0.044177246093749956, -0.041961669921875, -0.039578247070312544, -0.03702697753906259, -0.03434143066406259, -0.031588745117187456, -0.02863464355468759, -0.02561340332031259, -0.022457885742187544, -0.01923522949218759, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005807495117187589, -0.002349853515625, 0.0010742187499999112, 0.0045318603515625, 0.007922363281249956, 0.011312866210937411, 0.014636230468749956, 0.01789245605468759, 0.02108154296875009, 0.024169921875, 0.027191162109375, 0.030078124999999956, 0.03283081054687509, 0.03548278808593741, 0.037933349609375, 0.040316772460937456, 0.042498779296874956, 0.0444793701171875, 0.046359252929687456, 0.047970581054687544, 0.04941406249999991, 0.050656127929687544, 0.051730346679687456, 0.0525360107421875, 0.053173828125000044, 0.0535430908203125, 0.0537109375, 0.053677368164062544, 0.05344238281249991, 0.05293884277343741, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.048977661132812544, 0.04743347167968759, 0.045788574218750044, 0.04390869140625009, 0.04186096191406241, 0.039645385742187456, 0.037261962890625, 0.0347442626953125, 0.032092285156249956, 0.029238891601562456, 0.0263519287109375, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010339355468750089, 0.006915283203124956, 0.0035247802734375, 6.713867187491118e-05, -0.0033905029296874556, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.0169525146484375, -0.02020874023437491, -0.02339782714843741, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.037799072265624956, -0.040283203125, -0.042599487304687544, -0.044781494140625044, -0.046795654296875044, -0.04860839843750009, -0.050219726562499956, -0.051663208007812544, -0.05293884277343741, -0.05394592285156241, -0.05478515624999991, -0.055355834960937544, -0.05579223632812491, -0.05596008300781241, -0.055926513671874956, -0.055691528320312544, -0.0552215576171875, -0.0545501708984375, -0.053677368164062544, -0.052569580078124956, -0.05126037597656241, -0.04978332519531259, -0.04810485839843759, -0.04622497558593741, -0.0441436767578125, -0.041928100585937544, -0.03954467773437509, -0.03702697753906259, -0.03434143066406259, -0.031521606445312544, -0.02863464355468759, -0.02557983398437491, -0.022491455078125, -0.019268798828125044, -0.015979003906249956, -0.012622070312499956, -0.0092315673828125, -0.005807495117187589, -0.0023834228515624556, 0.0010742187499999112, 0.004498291015625044, 0.007922363281249956, 0.011312866210937411, 0.014669799804687411, 0.01789245605468759, 0.021115112304687544, 0.024169921875, 0.027191162109375, 0.030078124999999956, 0.032864379882812544, 0.03548278808593741, 0.037966918945312456, 0.040316772460937456, 0.042498779296874956, 0.044512939453124956, 0.04632568359375, 0.047970581054687544, 0.04944763183593759, 0.050689697265625, 0.051730346679687456, 0.052569580078124956, 0.053173828125000044, 0.053576660156249956, 0.053744506835937456, 0.0537109375, 0.05344238281249991, 0.05297241210937509, 0.05226745605468741, 0.051361083984375, 0.05025329589843741, 0.048977661132812544, 0.047467041015625044, 0.04575500488281259, 0.04390869140625009, 0.041827392578124956, 0.03967895507812491, 0.037261962890625, 0.034710693359375044, 0.0320587158203125, 0.029238891601562456, 0.026318359375000044, 0.023297119140625044, 0.020175170898437456, 0.0169525146484375, 0.013662719726562411, 0.010305786132812411, 0.006915283203124956, 0.0035247802734375, 6.713867187491118e-05, -0.00335693359375, -0.006814575195312589, -0.0102386474609375, -0.0135955810546875, -0.016918945312500044, -0.02020874023437491, -0.02339782714843741, -0.026486206054687544, -0.029507446289062544, -0.0323944091796875, -0.03514709472656241, -0.037799072265624956, -0.040283203125, -0.042599487304687544, -0.044781494140625044, -0.046795654296875044, -0.04860839843750009, -0.050219726562499956, -0.051663208007812544, -0.052905273437499956, -0.05394592285156241, -0.05478515624999991, -0.055389404296875, -0.05579223632812491, -0.05596008300781241, -0.055926513671874956, -0.055691528320312544];
xJS = xJS .* 4;
xJS = xJS(1:512);
XJS = [1.321461385637527,0.3437157209000522,0.45862193175389465,0.8062697677934038,2.46685630672512,190.30278702735842,3.229428836265093,0.6618326217870842,0.2681448064347385,0.14188330879188651,0.08882183463383336,0.05854972271635928,0.042304838841099396,0.0318621261437926,0.024996761870512738,0.01988126899577589,0.016745445375044847,0.01400112019261829,0.011923605728438785,0.010305399102372152,0.008886586291561359,0.00798627126903241,0.007052094331335641,0.006402448414946184,0.005702050081346045,0.005274525144481181,0.004485141637900589,0.004253782535613277,0.003936604979959379,0.003617900810974754,0.0033240210934521747,0.0032861105555716083,0.002958416142762454,0.0027293414599068124,0.0025616622751621575,0.0024067568977539843,0.0021494665640790695,0.0021053010757263245,0.002005661416077582,0.0018952466811190218,0.0018002407819557788,0.0017446837528677633,0.0016397798787946096,0.001534995055150305,0.0014708408247026078,0.0014113190615631776,0.0013336047640256116,0.0012699606699276048,0.001236013155897783,0.001178874241272403,0.0011258800978290588,0.0010804525427884762,0.0010511132946119115,0.001005978390847938,0.0009683018722134542,0.0009382795586406283,0.0008745444687002331,0.0008646057617265532,0.0008558900001268286,0.0008086635872587493,0.0007937409517643624,0.0007490714516949279,0.0007213857360169411,0.0007212517523239482,0.0006881303622015428,0.0006583740726020041,0.0006433276796942223,0.0006313276368682873,0.0006065689551694661,0.0005814645015286871,0.0005710860646653282,0.0005717148851172617,0.0005570894752497435,0.0005288566427296554,0.0005271903479668668,0.0005144519216555839,0.0004910826863064593,0.00048817710049649677,0.0004712337797509113,0.00046257191954553406,0.000445349314171725,0.00043167428090078625,0.0004103483745458801,0.00040413477668646076,0.0003969945900045619,0.00040085324826563673,0.0003913639438182881,0.00039293200946930644,0.0003686175241599378,0.0003589914587416478,0.0003607579545138761,0.0003452981120100478,0.00034786377346308076,0.0003546265891251449,0.00034803117244824893,0.0003356133888818362,0.00032560835187537266,0.0003159358786702652,0.00030971998597048724,0.000308481196133404,0.00030406529009462894,0.0002975001301073181,0.00028584449727916294,0.0002858570695802477,0.0002826720306089596,0.00027600727424881207,0.00026780848864120554,0.0002727760987588445,0.00025436891113702,0.000251115745716359,0.0002586972719529491,0.00025413734089230195,0.0002488140203202585,0.00024611777907365483,0.00024406628695275564,0.0002394725269298362,0.00023338287773661524,0.00023007629929827395,0.0002248325217674064,0.0002200705699043615,0.00022162488486081685,0.00021287461363443536,0.00021462656139892123,0.00020245984223763214,0.00020326746040227937,0.0001998116713626632,0.0002033310707400084,0.00021190993011279427,0.0001888166554271703,0.0001925127133759771,0.00019223838917664735,0.00018484832526495157,0.000187121915398337,0.00019071108582686307,0.00017569713144192643,0.0001786542294723957,0.00018278630595491613,0.00016853768090638636,0.00017988109966881385,0.00015938690549994518,0.0001677114599125025,0.0001705849070989931,0.0001626549968209651,0.00016727412914689004,0.00016618252533662394,0.00015747562455818405,0.00016803856022997539,0.00016818739307921589,0.00016468474072525014,0.00015088760583421628,0.00015950445341249427,0.00014357449497625683,0.00015201933059563578,0.00014473706958522694,0.000153732825537461,0.0001498314900738666,0.00014557481274082645,0.00014865891191958393,0.00014295914588147466,0.00015243006654064195,0.00013780117484655217,0.00014498862456553842,0.00014043242292739668,0.0001384166354397614,0.00013491836416759255,0.00013733605894399915,0.00013085892896989127,0.00012926173302800725,0.00013460096202459192,0.00013587375588985885,0.00013652755283767684,0.00013009787120516356,0.00013128387893585985,0.00012342474507644527,0.00013925853540807688,0.00013819833032311936,0.00013477330536830755,0.00013070110916689302,0.00013109614420401313,0.00012526895332592682,0.0001267812696506882,0.00011854509757414463,0.0001215831812395934,0.00012497429237146452,0.00011732594532066674,0.00011625503639734516,0.0001152470793617328,0.00011358144867018867,0.00011270264263255612,0.00011542781646751022,0.00011846115871210803,0.00011230885458689909,0.00011715708446651901,0.00011175323829257094,0.00011147561842522433,0.0001142807708212102,0.0001185976453321339,0.0001083233651071247,0.00011536913658967543,0.00010807725832698848,0.00011192486054538916,0.00011026046688917545,0.00011399264490973122,0.00011364007165648701,0.00010406059745695212,0.00011496103386407954,0.00010640513166725855,0.00010357088574903865,0.00010791411203969765,0.00010629520869552032,0.00011129241726410766,0.000101966003080623,0.00010496435711047706,0.00010267189691837344,0.00009756216144712409,0.00010976408567902929,0.00009783898365096359,0.00010841620185626188,0.00010010658612376699,0.00011263556770054034,0.00010506082138039554,0.00010873510284997046,0.00011143905490391781,0.00010204074023268567,0.00011394571878443957,0.00009824785152751618,0.00010531586340592032,0.00010046332797256388,0.00011035959272682012,0.00009680942852651945,0.0000951876573694733,0.00010129590533008191,0.00009797783989116787,0.00010086311550606667,0.00010492976081115768,0.00010504174546369124,0.00009817139590653907,0.00009534685833755657,0.00010137449786657252,0.00009800224518845835,0.00010570207009726922,0.00008985347101006672,0.00009624564424456687,0.00010000892928306212,0.00009489989466516804,0.0000926428271831044,0.00010480101685212861,0.00010428901558303466,0.00009849360476219981,0.00009615349582153785,0.00009743622413366308,0.00010188418040995412,0.00010452708081656168,0.00009136289115684455,0.00009657881501432478,0.00010470586727907727,0.00010551843792195436,0.00010470586727907727,0.00009657881501432587,0.00009136289115684031,0.0001045270808165594,0.00010188418040991833,0.00009743622413365434,0.00009615349582153459,0.00009849360476219706,0.00010428901558303523,0.00010480101685212804,0.00009264282718310387,0.00009489989466516804,0.0001000089292830635,0.00009624564424456646,0.00008985347101006791,0.00010570207009726865,0.00009800224518845644,0.00010137449786657235,0.00009534685833755523,0.0000981713959065386,0.00010504174546369124,0.00010492976081115768,0.00010086311550606645,0.00009797783989116774,0.00010129590533008233,0.0000951876573694739,0.00009680942852652092,0.00011035959272681933,0.00010046332797256408,0.00010531586340591992,0.00009824785152751682,0.0001139457187844395,0.00010204074023268491,0.00011143905490391788,0.00010873510284997004,0.0001050608213803961,0.00011263556770054076,0.00010010658612376642,0.0001084162018562617,0.00009783898365096345,0.00010976408567902902,0.00009756216144712379,0.00010267189691837434,0.00010496435711047699,0.00010196600308062444,0.00011129241726410772,0.00010629520869552128,0.00010791411203969765,0.00010357088574903755,0.00010640513166725855,0.0001149610338640778,0.00010406059745695216,0.00011364007165648942,0.00011399264490973132,0.00011026046688917532,0.00011192486054538934,0.00010807725832698821,0.00011536913658967556,0.00010832336510712638,0.0001185976453321329,0.0001142807708212121,0.00011147561842522349,0.00011175323829257137,0.00011715708446651897,0.00011230885458689856,0.00011846115871210878,0.00011542781646750858,0.00011270264263255702,0.00011358144867018928,0.0001152470793617328,0.0001162550363973451,0.00011732594532066653,0.00012497429237146455,0.0001215831812395932,0.00011854509757414189,0.00012678126965068797,0.00012526895332592736,0.00013109614420401302,0.00013070110916689365,0.00013477330536830744,0.00013819833032311887,0.000139258535408077,0.00012342474507644506,0.00013128387893586002,0.00013009787120516432,0.00013652755283767706,0.00013587375588985898,0.00013460096202459195,0.00012926173302800725,0.00013085892896989138,0.00013733605894400202,0.00013491836416759288,0.0001384166354397608,0.00014043242292739668,0.00014498862456553924,0.00013780117484655214,0.00015243006654064116,0.00014295914588147455,0.00014865891191958455,0.00014557481274082596,0.0001498314900738609,0.00015373282553746089,0.000144737069585227,0.00015201933059563576,0.0001435744949762566,0.000159504453412494,0.00015088760583421504,0.00016468474072525014,0.0001681873930792151,0.000168038560229975,0.00015747562455818454,0.00016618252533662396,0.00016727412914688982,0.0001626549968209655,0.00017058490709899335,0.00016771145991250253,0.000159386905499948,0.00017988109966881433,0.00016853768090638706,0.00018278630595491656,0.00017865422947239466,0.0001756971314419264,0.00019071108582685516,0.000187121915398337,0.00018484832526494995,0.00019223838917664784,0.00019251271337597558,0.0001888166554271703,0.0002119099301127959,0.00020333107074000788,0.00019981167136266461,0.00020326746040227937,0.00020245984223764057,0.0002146265613989212,0.00021287461363443634,0.00022162488486081626,0.00022007056990436068,0.0002248325217674059,0.00023007629929827059,0.000233382877736615,0.0002394725269298361,0.0002440662869527551,0.000246117779073655,0.00024881402032025837,0.00025413734089230135,0.0002586972719529495,0.00025111574571635943,0.00025436891113702,0.0002727760987588454,0.00026780848864120554,0.00027600727424881245,0.0002826720306089596,0.0002858570695802472,0.000285844497279163,0.0002975001301073198,0.0003040652900946292,0.00030848119613340313,0.00030971998597048746,0.0003159358786702658,0.00032560835187537266,0.0003356133888818354,0.0003480311724482487,0.0003546265891251455,0.0003478637734630803,0.0003452981120100482,0.0003607579545138761,0.0003589914587416482,0.00036861752415993763,0.0003929320094693061,0.0003913639438182881,0.00040085324826563587,0.0003969945900045617,0.00040413477668646113,0.0004103483745458798,0.00043167428090078674,0.00044534931417172487,0.0004625719195455335,0.0004712337797509114,0.000488177100496496,0.0004910826863064594,0.0005144519216555855,0.0005271903479668668,0.0005288566427296554,0.0005570894752497437,0.0005717148851172621,0.000571086064665328,0.0005814645015286758,0.0006065689551694645,0.0006313276368682889,0.0006433276796942221,0.0006583740726020041,0.0006881303622015428,0.000721251752323948,0.0007213857360169412,0.0007490714516949261,0.0007937409517643639,0.0008086635872587614,0.0008558900001268287,0.0008646057617265528,0.0008745444687002328,0.0009382795586406283,0.0009683018722134541,0.0010059783908479372,0.0010511132946119113,0.0010804525427884765,0.0011258800978290588,0.001178874241272403,0.001236013155897783,0.0012699606699276046,0.0013336047640256116,0.0014113190615631774,0.0014708408247026078,0.0015349950551503055,0.0016397798787946096,0.0017446837528677633,0.0018002407819557788,0.0018952466811190218,0.002005661416077582,0.0021053010757263245,0.0021494665640790695,0.0024067568977539843,0.0025616622751621575,0.0027293414599068124,0.0029584161427624544,0.0032861105555716083,0.003324021093452175,0.0036179008109747555,0.003936604979959378,0.00425378253561326,0.00448514163790059,0.005274525144481181,0.0057020500813460455,0.006402448414946187,0.007052094331335643,0.007986271269032418,0.008886586291561362,0.010305399102372152,0.011923605728438792,0.014001120192618313,0.016745445375044854,0.01988126899577586,0.024996761870512734,0.03186212614379261,0.04230483884109938,0.05854972271635911,0.08882183463383345,0.14188330879188665,0.2681448064347387,0.6618326217870842,3.2294288362650945,190.30278702735856,2.4668563067251212,0.8062697677934038,0.45862193175389476,0.3437157209000519];
XJS = XJS.^(1/2);
figure; hold on;
p1 = plot(fs / N * n, abs(fft(xJS)));
p2 = plot(fs / N * n, XJS);
legend([p1; p2], 'matlab', 'JS');
xJSi = ifft(XJS);
% 
X = fft(x);
r = snr(x)

Px = sum(x.^2)/N

PX = sum(abs(X).^2)/N^2

Xone = X(1:N/2+1);
Xone(2:end) = 2*Xone(2:end);

PXone = sum(abs(Xone).^2)/(2*N^2)
N

df = fs;

Pm = sum(abs(Xone).^2)/(2*N^2*df)

P = sum(Pm*df)


