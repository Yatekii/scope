%%
clear all; close all; clc;

N = 2000;
n = 1:N;

fs = 200e3; T = 1/fs;
f = 1e3;

x = cos(2*pi*f*n*T);
x = [0.03753051757812509, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.0250091552734375, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006613159179687411, -0.027392578124999956, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006646728515625089, -0.02742614746093741, -0.051361083984375, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.0250091552734375, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051361083984375, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.039913940429687544, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.039913940429687544, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.039913940429687544, -0.008862304687500044, 0.0250091552734375, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006579589843749956, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03753051757812509, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03753051757812509, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006579589843749956, -0.02742614746093741, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006613159179687411, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.039913940429687544, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006613159179687411, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03753051757812509, 0.006579589843749956, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008862304687500044, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03753051757812509, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03753051757812509, 0.006579589843749956, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02742614746093741, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02742614746093741, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.025042724609374956, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.04907836914062491, 0.053912353515624956, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.04901123046875, 0.053912353515624956, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.051394653320312456, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.037463378906249956, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03988037109375009, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008828735351562589, 0.02510986328125009, 0.04901123046875, 0.0538787841796875, 0.03749694824218741, 0.006579589843749956, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.037463378906249956, 0.006579589843749956, -0.02745971679687509, -0.051394653320312456, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02510986328125009, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008795166015624911, 0.02510986328125009, 0.049044799804687456, 0.053912353515624956, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02510986328125009, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.053912353515624956, 0.037463378906249956, 0.006579589843749956, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02510986328125009, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.03749694824218741, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03988037109375009, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.02745971679687509, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008828735351562589, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02510986328125009, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05612792968749991, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875, 0.037463378906249956, 0.0065460205078125, -0.027493286132812544, -0.05142822265624991, -0.05616149902343759, -0.03984680175781241, -0.008795166015624911, 0.02507629394531241, 0.049044799804687456, 0.0538787841796875];

% figure; plot(n, x)

X = fft(x);

Px = sum(x.^2)/N

PX = sum(abs(X).^2)/N^2

Xone = X(1:N/2+1);
Xone(2:end) = 2*Xone(2:end);

PXone = sum(abs(Xone).^2)/(2*N^2)

df = fs/N;

Pm = sum(abs(Xone).^2)/(2*N^2*df);

P = sum(Pm*df)


